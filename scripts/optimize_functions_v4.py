#!/usr/bin/env python3
"""
V4ç‰ˆæœ¬:ä¸“é—¨ä¼˜åŒ–å‡½æ•°/APIçš„ä½¿ç”¨è¯´æ˜
ä¸ºæ¯ä¸ªå‡½æ•°æ·»åŠ :
1. ä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¸ªå‡½æ•°
2. è¿™ä¸ªå‡½æ•°èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜
3. å®é™…åº”ç”¨åœºæ™¯
4. å¾ªåºæ¸è¿›çš„å±•å¼€
"""
import json
import os
import re
from pathlib import Path

# å‡½æ•°/APIçš„è¯¦ç»†è¯´æ˜æ˜ å°„
FUNCTION_DETAILS = {
    "nn.Module": {
        "intro": "ğŸ—ï¸ åƒæ­ç§¯æœ¨ä¸€æ ·,æ¨¡å—åŒ–æ„å»ºç¥ç»ç½‘ç»œ",
        "why_need": """
## ğŸ¤” ä¸ºä»€ä¹ˆè¦ç”¨nn.Module?

### é—®é¢˜1: ä»£ç å¤ªä¹±,ä¸å¥½ç®¡ç†

**ä¸ç”¨nn.Moduleçš„æƒ…å†µ:**
```python
# æ‰€æœ‰ä»£ç æ··åœ¨ä¸€èµ·,å¾ˆä¹±
w1 = torch.randn(10, 20)
b1 = torch.randn(20)
w2 = torch.randn(20, 5)
b2 = torch.randn(5)
# ... 100è¡Œä»£ç å
# å®Œå…¨ä¸çŸ¥é“è¿™äº›å˜é‡æ˜¯å¹²ä»€ä¹ˆçš„
```

**ç”¨nn.Moduleçš„æƒ…å†µ:**
```python
class MyNet(nn.Module):
    def __init__(self):
        self.layer1 = nn.Linear(10, 20)
        self.layer2 = nn.Linear(20, 5)
    def forward(self, x):
        x = self.layer1(x)
        x = self.layer2(x)
        return x
# æ¸…æ™°! ä¸€çœ¼å°±çŸ¥é“ç½‘ç»œç»“æ„
```

### é—®é¢˜2: åŠŸèƒ½ä¸å®Œæ•´,éœ€è¦è‡ªå·±å®ç°

**ä¸ç”¨nn.Moduleçš„é—®é¢˜:**
- éœ€è¦è‡ªå·±ç®¡ç†å‚æ•°(æƒé‡ã€åç½®)
- éœ€è¦è‡ªå·±å®ç°å‰å‘ä¼ æ’­
- éœ€è¦è‡ªå·±å¤„ç†æ¢¯åº¦
- éœ€è¦è‡ªå·±ä¿å­˜å’ŒåŠ è½½æ¨¡å‹
- å¤ªéº»çƒ¦,å®¹æ˜“å‡ºé”™!

**ç”¨nn.Moduleçš„å¥½å¤„:**
- âœ… è‡ªåŠ¨ç®¡ç†æ‰€æœ‰å‚æ•°
- âœ… è‡ªåŠ¨è®¡ç®—æ¢¯åº¦
- âœ… è‡ªåŠ¨ä¿å­˜/åŠ è½½æ¨¡å‹
- âœ… å¯ä»¥è½»æ¾ç§»åˆ°GPU
- âœ… ä»£ç ç®€æ´,ä¸æ˜“å‡ºé”™

### é—®é¢˜3: æ— æ³•å¤ç”¨ä»£ç 

**ä¸ç”¨nn.Module:**
- æ¯ä¸ªé¡¹ç›®éƒ½è¦é‡å†™ä¸€é
- ä»£ç æ— æ³•å¤ç”¨
- æµªè´¹æ—¶é—´

**ç”¨nn.Module:**
- å®šä¹‰ä¸€æ¬¡,åˆ°å¤„ä½¿ç”¨
- å¯ä»¥ç»§æ‰¿å’Œæ‰©å±•
- ä»£ç å¤ç”¨ç‡é«˜
""",
        "solve_what": """
## ğŸ¯ nn.Moduleèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜?

### 1. **ä»£ç ç»„ç»‡é—®é¢˜**
- âŒ ä¹‹å‰: æ‰€æœ‰ä»£ç æ··åœ¨ä¸€èµ·,1000è¡Œä»£ç æ‰¾ä¸åˆ°å¤´
- âœ… ç°åœ¨: æ¨¡å—åŒ–ç»„ç»‡,æ¯ä¸ªç±»è´Ÿè´£ä¸€ä¸ªåŠŸèƒ½

### 2. **å‚æ•°ç®¡ç†é—®é¢˜**
- âŒ ä¹‹å‰: æ‰‹åŠ¨ç®¡ç†æƒé‡ã€åç½®,å®¹æ˜“å‡ºé”™
- âœ… ç°åœ¨: è‡ªåŠ¨ç®¡ç†,ä¸ä¼šä¸¢å¤±å‚æ•°

### 3. **æ¨¡å‹ä¿å­˜é—®é¢˜**
- âŒ ä¹‹å‰: éœ€è¦æ‰‹åŠ¨ä¿å­˜æ¯ä¸ªå‚æ•°,å¾ˆéº»çƒ¦
- âœ… ç°åœ¨: ä¸€è¡Œä»£ç ä¿å­˜æ•´ä¸ªæ¨¡å‹

### 4. **ä»£ç å¤ç”¨é—®é¢˜**
- âŒ ä¹‹å‰: æ¯ä¸ªé¡¹ç›®é‡å†™,æµªè´¹æ—¶é—´
- âœ… ç°åœ¨: å®šä¹‰ä¸€æ¬¡,åˆ°å¤„ä½¿ç”¨

### 5. **GPUåŠ é€Ÿé—®é¢˜**
- âŒ ä¹‹å‰: éœ€è¦æ‰‹åŠ¨æŠŠæ¯ä¸ªå‚æ•°ç§»åˆ°GPU
- âœ… ç°åœ¨: ä¸€è¡Œä»£ç  `.to(device)` æå®š
""",
        "progressive": """
### ğŸ“š å¾ªåºæ¸è¿›å­¦ä¹ 

**ç¬¬ä¸€æ­¥: ç†è§£é—®é¢˜** (ä½ ç°åœ¨åœ¨è¿™é‡Œ)
- ä¸ºä»€ä¹ˆéœ€è¦nn.Module?
- ä¸ç”¨nn.Moduleæœ‰ä»€ä¹ˆé—®é¢˜?

**ç¬¬äºŒæ­¥: å­¦ä¹ åŸºæœ¬ç”¨æ³•** (æ¥ä¸‹æ¥)
- å¦‚ä½•å®šä¹‰è‡ªå·±çš„ç½‘ç»œç±»?
- å¦‚ä½•å®ç°forwardæ–¹æ³•?
- å¦‚ä½•ä½¿ç”¨å®šä¹‰å¥½çš„ç½‘ç»œ?

**ç¬¬ä¸‰æ­¥: é«˜çº§ç”¨æ³•** (æœ€å)
- å¦‚ä½•ä¿å­˜å’ŒåŠ è½½æ¨¡å‹?
- å¦‚ä½•ç§»åˆ°GPU?
- å¦‚ä½•æŸ¥çœ‹ç½‘ç»œç»“æ„?
""",
        "real_use": """
### ğŸŒ å®é™…åº”ç”¨åœºæ™¯

1. **å›¾åƒåˆ†ç±»æ¨¡å‹(ResNet)**
   - åœºæ™¯: è®­ç»ƒå›¾åƒåˆ†ç±»æ¨¡å‹
   - åº”ç”¨: ç”¨nn.Moduleå®šä¹‰ResNetç½‘ç»œç»“æ„
   - æ•ˆæœ: ä»£ç æ¸…æ™°,æ˜“äºç»´æŠ¤å’Œä¿®æ”¹
   - æ¡ˆä¾‹: ImageNetæ¯”èµ›è·å¥–æ¨¡å‹éƒ½ç”¨nn.Module

2. **äººè„¸è¯†åˆ«ç³»ç»Ÿ**
   - åœºæ™¯: æ‰‹æœºäººè„¸è§£é”
   - åº”ç”¨: ç”¨nn.Moduleå®šä¹‰äººè„¸è¯†åˆ«ç½‘ç»œ
   - æ•ˆæœ: æ¨¡å‹å¯ä»¥è½»æ¾ä¿å­˜å’Œéƒ¨ç½²
   - æ¡ˆä¾‹: Face IDä½¿ç”¨nn.Moduleæ„å»ºç½‘ç»œ

3. **è¯­éŸ³è¯†åˆ«ç³»ç»Ÿ**
   - åœºæ™¯: Siriã€å°çˆ±åŒå­¦
   - åº”ç”¨: ç”¨nn.Moduleå®šä¹‰è¯­éŸ³è¯†åˆ«ç½‘ç»œ
   - æ•ˆæœ: ä»£ç æ¨¡å—åŒ–,æ˜“äºæ‰©å±•
   - æ¡ˆä¾‹: ç§‘å¤§è®¯é£ä½¿ç”¨nn.Moduleæ„å»ºè¯­éŸ³æ¨¡å‹

4. **æ¨èç³»ç»Ÿ**
   - åœºæ™¯: æŠ–éŸ³ã€æ·˜å®æ¨è
   - åº”ç”¨: ç”¨nn.Moduleå®šä¹‰æ¨èç½‘ç»œ
   - æ•ˆæœ: å¯ä»¥è½»æ¾å°è¯•ä¸åŒçš„ç½‘ç»œç»“æ„
   - æ¡ˆä¾‹: æŠ–éŸ³æ¨èç³»ç»Ÿä½¿ç”¨nn.Module

5. **è‡ªåŠ¨é©¾é©¶**
   - åœºæ™¯: ç‰¹æ–¯æ‹‰Autopilot
   - åº”ç”¨: ç”¨nn.Moduleå®šä¹‰æ„ŸçŸ¥ç½‘ç»œ
   - æ•ˆæœ: æ¨¡å‹å¯ä»¥è½»æ¾éƒ¨ç½²åˆ°è½¦ä¸Š
   - æ¡ˆä¾‹: ç‰¹æ–¯æ‹‰ä½¿ç”¨nn.Moduleæ„å»ºè‡ªåŠ¨é©¾é©¶æ¨¡å‹
"""
    },
    
    "Sequential": {
        "intro": "ğŸ“š åƒå†™æ¸…å•ä¸€æ ·,é¡ºåºæ­å»ºç½‘ç»œ",
        "why_need": """
## ğŸ¤” ä¸ºä»€ä¹ˆè¦ç”¨Sequential?

### é—®é¢˜1: å®šä¹‰ç½‘ç»œå¤ªéº»çƒ¦

**ä¸ç”¨Sequentialçš„æƒ…å†µ:**
```python
class MyNet(nn.Module):
    def __init__(self):
        self.layer1 = nn.Linear(10, 20)
        self.layer2 = nn.ReLU()
        self.layer3 = nn.Linear(20, 5)
        self.layer4 = nn.Sigmoid()
    
    def forward(self, x):
        x = self.layer1(x)
        x = self.layer2(x)
        x = self.layer3(x)
        x = self.layer4(x)
        return x
# å†™äº†å¾ˆå¤šä»£ç ,ä½†ç½‘ç»œå¾ˆç®€å•
```

**ç”¨Sequentialçš„æƒ…å†µ:**
```python
model = nn.Sequential(
    nn.Linear(10, 20),
    nn.ReLU(),
    nn.Linear(20, 5),
    nn.Sigmoid()
)
# ç®€æ´! ä¸€ç›®äº†ç„¶!
```

### é—®é¢˜2: ç½‘ç»œç»“æ„ä¸æ¸…æ™°

**ä¸ç”¨Sequential:**
- éœ€è¦çœ‹forwardæ–¹æ³•æ‰çŸ¥é“ç½‘ç»œç»“æ„
- ç»“æ„åˆ†æ•£åœ¨å¤šä¸ªåœ°æ–¹
- ä¸å®¹æ˜“ç†è§£

**ç”¨Sequential:**
- ç½‘ç»œç»“æ„ä¸€ç›®äº†ç„¶
- ä»ä¸Šåˆ°ä¸‹,é¡ºåºæ¸…æ™°
- å®¹æ˜“ç†è§£å’Œä¿®æ”¹

### é—®é¢˜3: å¿«é€ŸåŸå‹å¼€å‘æ…¢

**ä¸ç”¨Sequential:**
- æ¯ä¸ªç½‘ç»œéƒ½è¦å†™ä¸€ä¸ªç±»
- å¼€å‘é€Ÿåº¦æ…¢
- ä¸é€‚åˆå¿«é€Ÿå®éªŒ

**ç”¨Sequential:**
- å‡ è¡Œä»£ç å°±èƒ½å®šä¹‰ç½‘ç»œ
- å¿«é€Ÿå®éªŒä¸åŒç»“æ„
- å¼€å‘æ•ˆç‡é«˜
""",
        "solve_what": """
## ğŸ¯ Sequentialèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜?

### 1. **ä»£ç ç®€æ´é—®é¢˜**
- âŒ ä¹‹å‰: éœ€è¦å†™ç±»ã€__init__ã€forward,ä»£ç å¤š
- âœ… ç°åœ¨: å‡ è¡Œä»£ç æå®š,ç®€æ´æ˜äº†

### 2. **ç»“æ„æ¸…æ™°é—®é¢˜**
- âŒ ä¹‹å‰: ç»“æ„åˆ†æ•£,ä¸å®¹æ˜“çœ‹
- âœ… ç°åœ¨: ä»ä¸Šåˆ°ä¸‹,ä¸€ç›®äº†ç„¶

### 3. **å¿«é€Ÿå¼€å‘é—®é¢˜**
- âŒ ä¹‹å‰: æ¯ä¸ªç½‘ç»œå†™ä¸€ä¸ªç±»,æ…¢
- âœ… ç°åœ¨: å¿«é€Ÿå®šä¹‰,å¿«é€Ÿå®éªŒ

### 4. **å­¦ä¹ æ›²çº¿é—®é¢˜**
- âŒ ä¹‹å‰: éœ€è¦ç†è§£ç±»ã€æ–¹æ³•ç­‰æ¦‚å¿µ
- âœ… ç°åœ¨: ç›´æ¥åˆ—æ¸…å•,å®¹æ˜“ç†è§£
""",
        "progressive": """
### ğŸ“š å¾ªåºæ¸è¿›å­¦ä¹ 

**ç¬¬ä¸€æ­¥: ç†è§£é—®é¢˜** (ä½ ç°åœ¨åœ¨è¿™é‡Œ)
- ä¸ºä»€ä¹ˆéœ€è¦Sequential?
- ä¸ç”¨Sequentialæœ‰ä»€ä¹ˆé—®é¢˜?

**ç¬¬äºŒæ­¥: å­¦ä¹ åŸºæœ¬ç”¨æ³•** (æ¥ä¸‹æ¥)
- å¦‚ä½•ç”¨Sequentialå®šä¹‰ç½‘ç»œ?
- å¦‚ä½•æ·»åŠ å±‚?
- å¦‚ä½•ä½¿ç”¨ç½‘ç»œ?

**ç¬¬ä¸‰æ­¥: å®é™…åº”ç”¨** (æœ€å)
- ä»€ä¹ˆæ—¶å€™ç”¨Sequential?
- ä»€ä¹ˆæ—¶å€™ç”¨nn.Module?
- å¦‚ä½•é€‰æ‹©?
""",
        "real_use": """
### ğŸŒ å®é™…åº”ç”¨åœºæ™¯

1. **å¿«é€ŸåŸå‹å¼€å‘**
   - åœºæ™¯: ç ”ç©¶æ–°ç®—æ³•æ—¶å¿«é€Ÿå®éªŒ
   - åº”ç”¨: ç”¨Sequentialå¿«é€Ÿæ­å»ºç½‘ç»œ
   - æ•ˆæœ: å¼€å‘é€Ÿåº¦æå‡5å€
   - æ¡ˆä¾‹: ç ”ç©¶äººå‘˜ç”¨Sequentialå¿«é€ŸéªŒè¯æƒ³æ³•

2. **ç®€å•åˆ†ç±»ä»»åŠ¡**
   - åœºæ™¯: ç®€å•çš„å›¾åƒåˆ†ç±»
   - åº”ç”¨: ç”¨Sequentialå®šä¹‰ç®€å•çš„CNN
   - æ•ˆæœ: ä»£ç ç®€æ´,æ˜“äºç†è§£
   - æ¡ˆä¾‹: CIFAR-10åˆ†ç±»å¸¸ç”¨Sequential

3. **æ•™å­¦æ¼”ç¤º**
   - åœºæ™¯: æ•™å­¦ç¥ç»ç½‘ç»œåŸºç¡€
   - åº”ç”¨: ç”¨Sequentialå±•ç¤ºç½‘ç»œç»“æ„
   - æ•ˆæœ: å­¦ç”Ÿå®¹æ˜“ç†è§£
   - æ¡ˆä¾‹: å¾ˆå¤šæ•™ç¨‹ç”¨Sequentialæ•™å­¦

4. **ç‰¹å¾æå–ç½‘ç»œ**
   - åœºæ™¯: æå–å›¾åƒç‰¹å¾
   - åº”ç”¨: ç”¨Sequentialå®šä¹‰ç‰¹å¾æå–å±‚
   - æ•ˆæœ: ç»“æ„æ¸…æ™°,æ˜“äºä¿®æ”¹
   - æ¡ˆä¾‹: è¿ç§»å­¦ä¹ å¸¸ç”¨Sequential

5. **ç®€å•å›å½’ä»»åŠ¡**
   - åœºæ™¯: æˆ¿ä»·é¢„æµ‹ã€é”€é‡é¢„æµ‹
   - åº”ç”¨: ç”¨Sequentialå®šä¹‰å›å½’ç½‘ç»œ
   - æ•ˆæœ: å¿«é€Ÿå¼€å‘,æ˜“äºè°ƒè¯•
   - æ¡ˆä¾‹: Kaggleç«èµ›å¸¸ç”¨Sequentialå¿«é€Ÿå¼€å‘
"""
    },
    
    "Tensorboard": {
        "intro": "ğŸ“Š åƒçœ‹ä»ªè¡¨ç›˜ä¸€æ ·,å®æ—¶ç›‘æ§è®­ç»ƒ",
        "why_need": """
## ğŸ¤” ä¸ºä»€ä¹ˆè¦ç”¨Tensorboard?

### é—®é¢˜1: è®­ç»ƒè¿‡ç¨‹æ˜¯"é»‘ç›’"

**ä¸ç”¨Tensorboardçš„æƒ…å†µ:**
```python
for epoch in range(100):
    train()
    loss = compute_loss()
    print(f"Epoch {epoch}, Loss: {loss}")
    # åªèƒ½çœ‹åˆ°æ•°å­—,ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆ
    # æŸå¤±æ˜¯ä¸Šå‡è¿˜æ˜¯ä¸‹é™? ä¸çŸ¥é“!
    # æ¨¡å‹å­¦å¾—æ€ä¹ˆæ ·? ä¸çŸ¥é“!
```

**ç”¨Tensorboardçš„æƒ…å†µ:**
- ğŸ“ˆ å®æ—¶çœ‹åˆ°æŸå¤±æ›²çº¿
- ğŸ“Š çœ‹åˆ°å‡†ç¡®ç‡å˜åŒ–
- ğŸ–¼ï¸ çœ‹åˆ°æ¨¡å‹è¾“å‡ºçš„å›¾ç‰‡
- ğŸ“‰ çœ‹åˆ°å‚æ•°åˆ†å¸ƒ
- ä¸€ç›®äº†ç„¶!

### é—®é¢˜2: è°ƒè¯•å›°éš¾

**ä¸ç”¨Tensorboard:**
- ä¸çŸ¥é“æ¨¡å‹å“ªé‡Œå‡ºäº†é—®é¢˜
- ä¸çŸ¥é“å‚æ•°æ˜¯å¦æ­£å¸¸
- ä¸çŸ¥é“æ¢¯åº¦æ˜¯å¦æ¶ˆå¤±
- è°ƒè¯•å…¨é çŒœ!

**ç”¨Tensorboard:**
- å¯è§†åŒ–æ‰€æœ‰ä¿¡æ¯
- å¿«é€Ÿå®šä½é—®é¢˜
- èŠ‚çœè°ƒè¯•æ—¶é—´

### é—®é¢˜3: æ— æ³•å¯¹æ¯”å®éªŒ

**ä¸ç”¨Tensorboard:**
- ä¸åŒå®éªŒçš„ç»“æœæ··åœ¨ä¸€èµ·
- æ— æ³•å¯¹æ¯”å“ªä¸ªæ›´å¥½
- ä¸çŸ¥é“å“ªä¸ªå‚æ•°æ›´ä¼˜

**ç”¨Tensorboard:**
- åŒæ—¶å¯¹æ¯”å¤šä¸ªå®éªŒ
- æ¸…æ™°çœ‹åˆ°å“ªä¸ªæ›´å¥½
- å¿«é€Ÿæ‰¾åˆ°æœ€ä½³å‚æ•°
""",
        "solve_what": """
## ğŸ¯ Tensorboardèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜?

### 1. **è®­ç»ƒç›‘æ§é—®é¢˜**
- âŒ ä¹‹å‰: åªèƒ½çœ‹æ•°å­—,ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆ
- âœ… ç°åœ¨: å¯è§†åŒ–æ›²çº¿,ä¸€ç›®äº†ç„¶

### 2. **è°ƒè¯•å›°éš¾é—®é¢˜**
- âŒ ä¹‹å‰: è°ƒè¯•å…¨é çŒœ,å¾ˆæ…¢
- âœ… ç°åœ¨: å¯è§†åŒ–ä¿¡æ¯,å¿«é€Ÿå®šä½é—®é¢˜

### 3. **å®éªŒå¯¹æ¯”é—®é¢˜**
- âŒ ä¹‹å‰: æ— æ³•å¯¹æ¯”ä¸åŒå®éªŒ
- âœ… ç°åœ¨: åŒæ—¶å¯¹æ¯”å¤šä¸ªå®éªŒ

### 4. **å‚æ•°è°ƒä¼˜é—®é¢˜**
- âŒ ä¹‹å‰: ä¸çŸ¥é“å“ªä¸ªå‚æ•°æ›´å¥½
- âœ… ç°åœ¨: å¯è§†åŒ–å¯¹æ¯”,å¿«é€Ÿæ‰¾åˆ°æœ€ä½³å‚æ•°

### 5. **æ¨¡å‹ç†è§£é—®é¢˜**
- âŒ ä¹‹å‰: ä¸çŸ¥é“æ¨¡å‹å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆ
- âœ… ç°åœ¨: å¯è§†åŒ–æ¨¡å‹ç»“æ„ã€å‚æ•°ã€è¾“å‡º
""",
        "progressive": """
### ğŸ“š å¾ªåºæ¸è¿›å­¦ä¹ 

**ç¬¬ä¸€æ­¥: ç†è§£é—®é¢˜** (ä½ ç°åœ¨åœ¨è¿™é‡Œ)
- ä¸ºä»€ä¹ˆéœ€è¦Tensorboard?
- ä¸ç”¨Tensorboardæœ‰ä»€ä¹ˆé—®é¢˜?

**ç¬¬äºŒæ­¥: å­¦ä¹ åŸºæœ¬ç”¨æ³•** (æ¥ä¸‹æ¥)
- å¦‚ä½•è®°å½•æŸå¤±?
- å¦‚ä½•è®°å½•å‡†ç¡®ç‡?
- å¦‚ä½•æŸ¥çœ‹å¯è§†åŒ–?

**ç¬¬ä¸‰æ­¥: é«˜çº§ç”¨æ³•** (æœ€å)
- å¦‚ä½•è®°å½•å›¾ç‰‡?
- å¦‚ä½•è®°å½•æ¨¡å‹ç»“æ„?
- å¦‚ä½•å¯¹æ¯”å®éªŒ?
""",
        "real_use": """
### ğŸŒ å®é™…åº”ç”¨åœºæ™¯

1. **æ¨¡å‹è®­ç»ƒç›‘æ§**
   - åœºæ™¯: è®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹
   - åº”ç”¨: ç”¨Tensorboardå®æ—¶ç›‘æ§è®­ç»ƒè¿‡ç¨‹
   - æ•ˆæœ: åŠæ—¶å‘ç°è®­ç»ƒé—®é¢˜,èŠ‚çœæ—¶é—´
   - æ¡ˆä¾‹: æ‰€æœ‰æ·±åº¦å­¦ä¹ é¡¹ç›®éƒ½ç”¨Tensorboard

2. **è¶…å‚æ•°è°ƒä¼˜**
   - åœºæ™¯: å¯»æ‰¾æœ€ä½³è¶…å‚æ•°
   - åº”ç”¨: ç”¨Tensorboardå¯¹æ¯”ä¸åŒå‚æ•°çš„æ•ˆæœ
   - æ•ˆæœ: å¿«é€Ÿæ‰¾åˆ°æœ€ä½³å‚æ•°
   - æ¡ˆä¾‹: ç ”ç©¶äººå‘˜ç”¨Tensorboardè°ƒå‚

3. **æ¨¡å‹è°ƒè¯•**
   - åœºæ™¯: æ¨¡å‹æ•ˆæœä¸å¥½,éœ€è¦è°ƒè¯•
   - åº”ç”¨: ç”¨TensorboardæŸ¥çœ‹æ¢¯åº¦ã€å‚æ•°åˆ†å¸ƒ
   - æ•ˆæœ: å¿«é€Ÿå®šä½é—®é¢˜
   - æ¡ˆä¾‹: å·¥ç¨‹å¸ˆç”¨Tensorboardè°ƒè¯•æ¨¡å‹

4. **å®éªŒç®¡ç†**
   - åœºæ™¯: ç®¡ç†å¤šä¸ªå®éªŒ
   - åº”ç”¨: ç”¨Tensorboardè®°å½•å’Œå¯¹æ¯”å®éªŒ
   - æ•ˆæœ: æ¸…æ™°ç®¡ç†æ‰€æœ‰å®éªŒ
   - æ¡ˆä¾‹: ç ”ç©¶å›¢é˜Ÿç”¨Tensorboardç®¡ç†å®éªŒ

5. **æ¨¡å‹å¯è§†åŒ–**
   - åœºæ™¯: å‘ä»–äººå±•ç¤ºæ¨¡å‹æ•ˆæœ
   - åº”ç”¨: ç”¨Tensorboardç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Š
   - æ•ˆæœ: ç›´è§‚å±•ç¤ºæ¨¡å‹æ€§èƒ½
   - æ¡ˆä¾‹: è®ºæ–‡ã€æŠ¥å‘Šå¸¸ç”¨Tensorboardå¯è§†åŒ–
"""
    },
    
    "æŸå¤±å‡½æ•°": {
        "intro": "ğŸ“ å¦‚ä½•çŸ¥é“AIå­¦å¾—å¥½ä¸å¥½?å°±åƒè€ƒè¯•æ‰“åˆ†",
        "why_need": """
## ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦æŸå¤±å‡½æ•°?

### é—®é¢˜1: ä¸çŸ¥é“æ¨¡å‹å­¦å¾—æ€ä¹ˆæ ·

**æ²¡æœ‰æŸå¤±å‡½æ•°:**
```python
model.train()
# è®­ç»ƒäº†100è½®
# ä½†æ˜¯...å­¦å¾—æ€ä¹ˆæ ·? ä¸çŸ¥é“!
# æ˜¯å¥½æ˜¯å? ä¸çŸ¥é“!
```

**æœ‰æŸå¤±å‡½æ•°:**
```python
loss = loss_function(predictions, targets)
# loss = 0.5 â†’ å­¦å¾—ä¸é”™
# loss = 10.0 â†’ å­¦å¾—å¾ˆå·®
# ä¸€ç›®äº†ç„¶!
```

### é—®é¢˜2: æ— æ³•æŒ‡å¯¼è®­ç»ƒ

**æ²¡æœ‰æŸå¤±å‡½æ•°:**
- ä¸çŸ¥é“å‚æ•°åº”è¯¥æ€ä¹ˆè°ƒæ•´
- ä¸çŸ¥é“è®­ç»ƒæ–¹å‘å¯¹ä¸å¯¹
- è®­ç»ƒæ˜¯ç›²ç›®çš„

**æœ‰æŸå¤±å‡½æ•°:**
- æŸå¤±å¤§ â†’ éœ€è¦è°ƒæ•´å‚æ•°
- æŸå¤±å° â†’ å­¦å¾—ä¸é”™,ç»§ç»­
- æœ‰æ˜ç¡®çš„æ–¹å‘

### é—®é¢˜3: æ— æ³•æ¯”è¾ƒä¸åŒæ¨¡å‹

**æ²¡æœ‰æŸå¤±å‡½æ•°:**
- æ¨¡å‹Aå’Œæ¨¡å‹Bå“ªä¸ªæ›´å¥½?
- ä¸çŸ¥é“!
- æ— æ³•é€‰æ‹©

**æœ‰æŸå¤±å‡½æ•°:**
- æ¨¡å‹AæŸå¤±=0.5
- æ¨¡å‹BæŸå¤±=0.3
- æ¨¡å‹Bæ›´å¥½! ä¸€ç›®äº†ç„¶
""",
        "solve_what": """
## ğŸ¯ æŸå¤±å‡½æ•°èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜?

### 1. **è¯„ä¼°æ¨¡å‹é—®é¢˜**
- âŒ ä¹‹å‰: ä¸çŸ¥é“æ¨¡å‹å­¦å¾—æ€ä¹ˆæ ·
- âœ… ç°åœ¨: æŸå¤±å€¼ç›´æ¥åæ˜ æ¨¡å‹å¥½å

### 2. **æŒ‡å¯¼è®­ç»ƒé—®é¢˜**
- âŒ ä¹‹å‰: è®­ç»ƒæ²¡æœ‰æ–¹å‘
- âœ… ç°åœ¨: æŸå¤±å‡½æ•°æŒ‡å¯¼å‚æ•°è°ƒæ•´

### 3. **æ¨¡å‹æ¯”è¾ƒé—®é¢˜**
- âŒ ä¹‹å‰: æ— æ³•æ¯”è¾ƒä¸åŒæ¨¡å‹
- âœ… ç°åœ¨: ç”¨æŸå¤±å€¼ç›´æ¥æ¯”è¾ƒ

### 4. **ä¼˜åŒ–ç›®æ ‡é—®é¢˜**
- âŒ ä¹‹å‰: ä¸çŸ¥é“ä¼˜åŒ–ä»€ä¹ˆ
- âœ… ç°åœ¨: æ˜ç¡®ä¼˜åŒ–ç›®æ ‡(æœ€å°åŒ–æŸå¤±)

### 5. **è®­ç»ƒåœæ­¢é—®é¢˜**
- âŒ ä¹‹å‰: ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™åœæ­¢è®­ç»ƒ
- âœ… ç°åœ¨: æŸå¤±ä¸å†ä¸‹é™å°±åœæ­¢
""",
        "progressive": """
### ğŸ“š å¾ªåºæ¸è¿›å­¦ä¹ 

**ç¬¬ä¸€æ­¥: ç†è§£é—®é¢˜** (ä½ ç°åœ¨åœ¨è¿™é‡Œ)
- ä¸ºä»€ä¹ˆéœ€è¦æŸå¤±å‡½æ•°?
- æŸå¤±å‡½æ•°çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?

**ç¬¬äºŒæ­¥: å­¦ä¹ ä¸åŒç±»å‹çš„æŸå¤±å‡½æ•°** (æ¥ä¸‹æ¥)
- å›å½’ä»»åŠ¡ç”¨ä»€ä¹ˆæŸå¤±å‡½æ•°?
- åˆ†ç±»ä»»åŠ¡ç”¨ä»€ä¹ˆæŸå¤±å‡½æ•°?
- å¦‚ä½•é€‰æ‹©?

**ç¬¬ä¸‰æ­¥: å®é™…åº”ç”¨** (æœ€å)
- å¦‚ä½•å®šä¹‰æŸå¤±å‡½æ•°?
- å¦‚ä½•ä½¿ç”¨æŸå¤±å‡½æ•°è®­ç»ƒ?
- å¦‚ä½•è¯„ä¼°æ•ˆæœ?
""",
        "real_use": """
### ğŸŒ å®é™…åº”ç”¨åœºæ™¯

1. **å›¾åƒåˆ†ç±»(äº¤å‰ç†µæŸå¤±)**
   - åœºæ™¯: è®­ç»ƒå›¾åƒåˆ†ç±»æ¨¡å‹
   - åº”ç”¨: ç”¨äº¤å‰ç†µæŸå¤±è¯„ä¼°åˆ†ç±»å‡†ç¡®ç‡
   - æ•ˆæœ: å‡†ç¡®è¯„ä¼°æ¨¡å‹,æŒ‡å¯¼è®­ç»ƒ
   - æ¡ˆä¾‹: ImageNetæ¯”èµ›éƒ½ç”¨äº¤å‰ç†µæŸå¤±

2. **ç›®æ ‡æ£€æµ‹(å¤šä»»åŠ¡æŸå¤±)**
   - åœºæ™¯: è®­ç»ƒç›®æ ‡æ£€æµ‹æ¨¡å‹
   - åº”ç”¨: ç”¨å¤šä»»åŠ¡æŸå¤±(åˆ†ç±»+å®šä½)
   - æ•ˆæœ: åŒæ—¶ä¼˜åŒ–åˆ†ç±»å’Œå®šä½
   - æ¡ˆä¾‹: YOLOã€SSDéƒ½ç”¨å¤šä»»åŠ¡æŸå¤±

3. **äººè„¸è¯†åˆ«(å¯¹æ¯”æŸå¤±)**
   - åœºæ™¯: è®­ç»ƒäººè„¸è¯†åˆ«æ¨¡å‹
   - åº”ç”¨: ç”¨å¯¹æ¯”æŸå¤±å­¦ä¹ äººè„¸ç‰¹å¾
   - æ•ˆæœ: è®©ç›¸ä¼¼äººè„¸ç‰¹å¾æ¥è¿‘
   - æ¡ˆä¾‹: Face IDä½¿ç”¨å¯¹æ¯”æŸå¤±

4. **æœºå™¨ç¿»è¯‘(åºåˆ—æŸå¤±)**
   - åœºæ™¯: è®­ç»ƒç¿»è¯‘æ¨¡å‹
   - åº”ç”¨: ç”¨åºåˆ—æŸå¤±è¯„ä¼°ç¿»è¯‘è´¨é‡
   - æ•ˆæœ: å‡†ç¡®è¯„ä¼°ç¿»è¯‘æ•ˆæœ
   - æ¡ˆä¾‹: Googleç¿»è¯‘ä½¿ç”¨åºåˆ—æŸå¤±

5. **æ¨èç³»ç»Ÿ(æ’åºæŸå¤±)**
   - åœºæ™¯: è®­ç»ƒæ¨èæ¨¡å‹
   - åº”ç”¨: ç”¨æ’åºæŸå¤±ä¼˜åŒ–æ¨èé¡ºåº
   - æ•ˆæœ: æ¨èæ›´ç¬¦åˆç”¨æˆ·å–œå¥½
   - æ¡ˆä¾‹: æŠ–éŸ³æ¨èä½¿ç”¨æ’åºæŸå¤±
"""
    },
    
    "ä¼˜åŒ–å™¨": {
        "intro": "ğŸ¯ å¦‚ä½•æ‰¾åˆ°æœ€ä½³å‚æ•°?å°±åƒGPSå¯¼èˆª",
        "why_need": """
## ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦ä¼˜åŒ–å™¨?

### é—®é¢˜1: æ‰‹åŠ¨è°ƒå‚å¤ªæ…¢

**ä¸ç”¨ä¼˜åŒ–å™¨:**
```python
# æ‰‹åŠ¨è°ƒæ•´å‚æ•°
w = w - 0.01 * gradient  # å­¦ä¹ ç‡0.01
# æ•ˆæœä¸å¥½,æ”¹æˆ0.001
w = w - 0.001 * gradient
# è¿˜æ˜¯ä¸å¥½,æ”¹æˆ0.0001
w = w - 0.0001 * gradient
# å¤ªæ…¢äº†! è¦è¯•åˆ°ä»€ä¹ˆæ—¶å€™?
```

**ç”¨ä¼˜åŒ–å™¨:**
```python
optimizer = torch.optim.Adam(model.parameters(), lr=0.001)
optimizer.step()  # è‡ªåŠ¨è°ƒæ•´,åˆå¿«åˆå¥½!
```

### é—®é¢˜2: å­¦ä¹ ç‡å›ºå®š,æ•ˆæœä¸å¥½

**ä¸ç”¨ä¼˜åŒ–å™¨:**
- å­¦ä¹ ç‡å¤ªå¤§ â†’ è®­ç»ƒä¸ç¨³å®š,å¯èƒ½å‘æ•£
- å­¦ä¹ ç‡å¤ªå° â†’ è®­ç»ƒå¤ªæ…¢,æµªè´¹æ—¶é—´
- å›ºå®šå­¦ä¹ ç‡ â†’ æ— æ³•é€‚åº”ä¸åŒé˜¶æ®µ

**ç”¨ä¼˜åŒ–å™¨:**
- è‡ªé€‚åº”å­¦ä¹ ç‡ â†’ è‡ªåŠ¨è°ƒæ•´
- è®­ç»ƒç¨³å®š â†’ ä¸ä¼šå‘æ•£
- è®­ç»ƒå¿«é€Ÿ â†’ æ”¶æ•›å¿«

### é—®é¢˜3: å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜

**ä¸ç”¨ä¼˜åŒ–å™¨:**
- å¯èƒ½åœåœ¨å±€éƒ¨æœ€ä¼˜
- æ‰¾ä¸åˆ°å…¨å±€æœ€ä¼˜
- æ¨¡å‹æ•ˆæœä¸å¥½

**ç”¨ä¼˜åŒ–å™¨:**
- æœ‰åŠ¨é‡æœºåˆ¶ â†’ è·³å‡ºå±€éƒ¨æœ€ä¼˜
- æ‰¾åˆ°æ›´å¥½çš„è§£
- æ¨¡å‹æ•ˆæœæ›´å¥½
""",
        "solve_what": """
## ğŸ¯ ä¼˜åŒ–å™¨èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜?

### 1. **å‚æ•°è°ƒæ•´é—®é¢˜**
- âŒ ä¹‹å‰: æ‰‹åŠ¨è°ƒæ•´,å¤ªæ…¢
- âœ… ç°åœ¨: è‡ªåŠ¨è°ƒæ•´,å¿«é€Ÿ

### 2. **å­¦ä¹ ç‡é—®é¢˜**
- âŒ ä¹‹å‰: å›ºå®šå­¦ä¹ ç‡,æ•ˆæœä¸å¥½
- âœ… ç°åœ¨: è‡ªé€‚åº”å­¦ä¹ ç‡,æ•ˆæœå¥½

### 3. **è®­ç»ƒç¨³å®šæ€§é—®é¢˜**
- âŒ ä¹‹å‰: å®¹æ˜“å‘æ•£,è®­ç»ƒä¸ç¨³å®š
- âœ… ç°åœ¨: ç¨³å®šè®­ç»ƒ,ä¸ä¼šå‘æ•£

### 4. **å±€éƒ¨æœ€ä¼˜é—®é¢˜**
- âŒ ä¹‹å‰: å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜
- âœ… ç°åœ¨: æœ‰æœºåˆ¶è·³å‡ºå±€éƒ¨æœ€ä¼˜

### 5. **è®­ç»ƒé€Ÿåº¦é—®é¢˜**
- âŒ ä¹‹å‰: è®­ç»ƒæ…¢,æµªè´¹æ—¶é—´
- âœ… ç°åœ¨: å¿«é€Ÿæ”¶æ•›,èŠ‚çœæ—¶é—´
""",
        "progressive": """
### ğŸ“š å¾ªåºæ¸è¿›å­¦ä¹ 

**ç¬¬ä¸€æ­¥: ç†è§£é—®é¢˜** (ä½ ç°åœ¨åœ¨è¿™é‡Œ)
- ä¸ºä»€ä¹ˆéœ€è¦ä¼˜åŒ–å™¨?
- ä¸ç”¨ä¼˜åŒ–å™¨æœ‰ä»€ä¹ˆé—®é¢˜?

**ç¬¬äºŒæ­¥: å­¦ä¹ ä¸åŒç±»å‹çš„ä¼˜åŒ–å™¨** (æ¥ä¸‹æ¥)
- SGDæ˜¯ä»€ä¹ˆ? ä»€ä¹ˆæ—¶å€™ç”¨?
- Adamæ˜¯ä»€ä¹ˆ? ä»€ä¹ˆæ—¶å€™ç”¨?
- å¦‚ä½•é€‰æ‹©?

**ç¬¬ä¸‰æ­¥: å®é™…åº”ç”¨** (æœ€å)
- å¦‚ä½•å®šä¹‰ä¼˜åŒ–å™¨?
- å¦‚ä½•ä½¿ç”¨ä¼˜åŒ–å™¨è®­ç»ƒ?
- å¦‚ä½•è°ƒä¼˜?
""",
        "real_use": """
### ğŸŒ å®é™…åº”ç”¨åœºæ™¯

1. **å›¾åƒåˆ†ç±»è®­ç»ƒ(Adamä¼˜åŒ–å™¨)**
   - åœºæ™¯: è®­ç»ƒImageNetåˆ†ç±»æ¨¡å‹
   - åº”ç”¨: ç”¨Adamä¼˜åŒ–å™¨è‡ªåŠ¨è°ƒæ•´å­¦ä¹ ç‡
   - æ•ˆæœ: è®­ç»ƒé€Ÿåº¦å¿«,æ•ˆæœå¥½
   - æ¡ˆä¾‹: å¤§å¤šæ•°å›¾åƒåˆ†ç±»æ¨¡å‹ç”¨Adam

2. **GANè®­ç»ƒ(Adamä¼˜åŒ–å™¨)**
   - åœºæ™¯: è®­ç»ƒç”Ÿæˆå¯¹æŠ—ç½‘ç»œ
   - åº”ç”¨: ç”¨Adamä¼˜åŒ–å™¨ç¨³å®šè®­ç»ƒ
   - æ•ˆæœ: è®­ç»ƒç¨³å®š,ä¸æ˜“å‘æ•£
   - æ¡ˆä¾‹: StyleGANç­‰éƒ½ç”¨Adam

3. **BERTè®­ç»ƒ(AdamWä¼˜åŒ–å™¨)**
   - åœºæ™¯: è®­ç»ƒBERTè¯­è¨€æ¨¡å‹
   - åº”ç”¨: ç”¨AdamWä¼˜åŒ–å™¨(å¸¦æƒé‡è¡°å‡)
   - æ•ˆæœ: é˜²æ­¢è¿‡æ‹Ÿåˆ,æ•ˆæœå¥½
   - æ¡ˆä¾‹: BERTã€GPTéƒ½ç”¨AdamW

4. **å¼ºåŒ–å­¦ä¹ (SGDä¼˜åŒ–å™¨)**
   - åœºæ™¯: è®­ç»ƒå¼ºåŒ–å­¦ä¹ æ¨¡å‹
   - åº”ç”¨: ç”¨SGDä¼˜åŒ–å™¨(æ›´ç¨³å®š)
   - æ•ˆæœ: è®­ç»ƒç¨³å®š,æ”¶æ•›å¥½
   - æ¡ˆä¾‹: AlphaGoç”¨SGD

5. **æ¨èç³»ç»Ÿ(å¤šç§ä¼˜åŒ–å™¨)**
   - åœºæ™¯: è®­ç»ƒæ¨èæ¨¡å‹
   - åº”ç”¨: æ ¹æ®ä»»åŠ¡é€‰æ‹©ä¼˜åŒ–å™¨
   - æ•ˆæœ: å¿«é€Ÿæ‰¾åˆ°æœ€ä½³å‚æ•°
   - æ¡ˆä¾‹: æŠ–éŸ³æ¨èç³»ç»Ÿç”¨å¤šç§ä¼˜åŒ–å™¨
"""
    }
}

def get_function_details(filename, title):
    """è·å–å‡½æ•°/APIçš„è¯¦ç»†è¯´æ˜"""
    filename_lower = filename.lower()
    title_lower = title.lower()
    
    # æ£€æŸ¥æ˜¯å¦åŒ¹é…å·²å®šä¹‰çš„å‡½æ•°
    for func_name, details in FUNCTION_DETAILS.items():
        if func_name.lower() in filename_lower or func_name.lower() in title_lower:
            return details
    
    # æ ¹æ®å…³é”®è¯ç”Ÿæˆé€šç”¨è¯´æ˜
    if "module" in title_lower or "æ¨¡å—" in title_lower:
        return FUNCTION_DETAILS["nn.Module"]
    elif "sequential" in title_lower:
        return FUNCTION_DETAILS["Sequential"]
    elif "tensorboard" in title_lower:
        return FUNCTION_DETAILS["Tensorboard"]
    elif "æŸå¤±" in title_lower or "loss" in title_lower:
        return FUNCTION_DETAILS["æŸå¤±å‡½æ•°"]
    elif "ä¼˜åŒ–å™¨" in title_lower or "optimizer" in title_lower:
        return FUNCTION_DETAILS["ä¼˜åŒ–å™¨"]
    
    return None

def enhance_function_notebook(notebook_path):
    """å¢å¼ºå‡½æ•°/APIç›¸å…³çš„ç¬”è®°æœ¬"""
    try:
        with open(notebook_path, 'r', encoding='utf-8') as f:
            notebook = json.load(f)
        
        if not notebook.get('cells'):
            return False
        
        filename = os.path.basename(notebook_path)
        title = extract_title_from_filename(filename)
        
        # è·å–å‡½æ•°è¯¦ç»†è¯´æ˜
        func_details = get_function_details(filename, title)
        if not func_details:
            return False
        
        # æ£€æŸ¥æ˜¯å¦å·²ç»ä¼˜åŒ–è¿‡(æ£€æŸ¥æ˜¯å¦æœ‰"ä¸ºä»€ä¹ˆè¦ç”¨"éƒ¨åˆ†)
        first_cell = notebook['cells'][0]
        if first_cell['cell_type'] == 'markdown':
            content = ''.join(first_cell['source'])
            if 'ğŸ¤” ä¸ºä»€ä¹ˆè¦ç”¨' in content and func_details['why_need'].split('\n')[1].strip() in content:
                # æ£€æŸ¥å®é™…åº”ç”¨éƒ¨åˆ†æ˜¯å¦ä¹Ÿæ˜¯é’ˆå¯¹è¿™ä¸ªå‡½æ•°çš„
                has_correct_apps = False
                for cell in notebook['cells']:
                    if cell['cell_type'] == 'markdown':
                        app_content = ''.join(cell['source'])
                        if 'å®é™…åº”ç”¨åœºæ™¯' in app_content:
                            # æ£€æŸ¥æ˜¯å¦åŒ…å«å‡½æ•°ç‰¹å®šçš„åº”ç”¨(æ¯”å¦‚nn.Moduleç›¸å…³çš„åº”ç”¨)
                            if 'ResNet' in app_content or 'Face ID' in app_content or 'å›¾åƒåˆ†ç±»' in app_content:
                                has_correct_apps = True
                                break
                
                if has_correct_apps:
                    print(f"  âœ“ {filename} å·²ç»ä¼˜åŒ–è¿‡(V4ç‰ˆæœ¬,åº”ç”¨æ­£ç¡®)")
                    return False
                else:
                    # æœ‰"ä¸ºä»€ä¹ˆè¦ç”¨"ä½†æ²¡æœ‰æ­£ç¡®çš„åº”ç”¨,éœ€è¦æ›´æ–°åº”ç”¨éƒ¨åˆ†
                    print(f"  â†’ {filename} éœ€è¦æ›´æ–°åº”ç”¨éƒ¨åˆ†")
        
        # åˆ›å»ºå¢å¼ºç‰ˆå¼•å…¥
        intro_cell = {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                f"# {title}\n",
                "\n",
                f"**{func_details['intro']}**\n",
                "\n",
                "---\n",
                "\n",
                func_details['why_need'],
                "\n",
                "---\n",
                "\n",
                func_details['solve_what'],
                "\n",
                "---\n",
                "\n",
                func_details['progressive'],
                "\n",
                "---\n",
                "\n",
                "## ğŸ¯ æœ¬èŠ‚è¯¾ä½ å°†å­¦ä¼š\n",
                "\n",
                "- âœ… ç†è§£ä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¸ªå‡½æ•°\n",
                "- âœ… çŸ¥é“è¿™ä¸ªå‡½æ•°èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜\n",
                "- âœ… æŒæ¡å¦‚ä½•å®é™…åº”ç”¨\n",
                "- âœ… ç†è§£å¾ªåºæ¸è¿›çš„å±•å¼€\n",
                "\n",
                "## ğŸ’¡ å­¦ä¹ å»ºè®®\n",
                "\n",
                "1. **å…ˆç†è§£\"ä¸ºä»€ä¹ˆ\"** - ä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¸ªå‡½æ•°?\n",
                "2. **å†ç†è§£\"æ˜¯ä»€ä¹ˆ\"** - è¿™ä¸ªå‡½æ•°èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜?\n",
                "3. **æœ€åæŒæ¡\"æ€ä¹ˆåš\"** - å¦‚ä½•å®é™…åº”ç”¨?\n",
                "4. **åŠ¨æ‰‹å®è·µ** - è¿è¡Œä»£ç ,ä¿®æ”¹å‚æ•°,è§‚å¯Ÿç»“æœ\n",
                "\n",
                "---\n",
                "\n"
            ]
        }
        
        # åˆ›å»ºå®é™…åº”ç”¨ç« èŠ‚
        real_use_cell = {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "---\n",
                "\n",
                func_details['real_use'],
                "\n",
                "---\n",
                "\n"
            ]
        }
        
        # æ›¿æ¢ç¬¬ä¸€ä¸ªcell
        notebook['cells'][0] = intro_cell
        
        # åˆ é™¤æ—§çš„å®é™…åº”ç”¨éƒ¨åˆ†(å¦‚æœæ˜¯é€šç”¨çš„æˆ–ä¸æ˜¯é’ˆå¯¹è¿™ä¸ªå‡½æ•°çš„)
        app_cell_index = -1
        for i, cell in enumerate(notebook['cells']):
            if cell['cell_type'] == 'markdown':
                content = ''.join(cell['source'])
                if 'å®é™…åº”ç”¨åœºæ™¯' in content or ('å®é™…åº”ç”¨' in content and 'ğŸŒ' in content):
                    # æ£€æŸ¥æ˜¯å¦æ˜¯é€šç”¨çš„åº”ç”¨æˆ–ä¸åŒ…å«å‡½æ•°ç‰¹å®šçš„å…³é”®è¯
                    is_generic = 'æ‰‹æœºæ‹ç…§ä¼˜åŒ–' in content or 'æ™ºèƒ½å®¶å±…' in content
                    # æ£€æŸ¥æ˜¯å¦åŒ…å«å‡½æ•°ç‰¹å®šçš„åº”ç”¨å…³é”®è¯
                    has_specific = False
                    if 'nn.Module' in filename or 'Module' in filename:
                        has_specific = 'ResNet' in content or 'Face ID' in content or 'å›¾åƒåˆ†ç±»æ¨¡å‹' in content
                    elif 'Sequential' in filename:
                        has_specific = 'å¿«é€ŸåŸå‹' in content or 'ç®€å•åˆ†ç±»' in content
                    elif 'Tensorboard' in filename:
                        has_specific = 'è®­ç»ƒç›‘æ§' in content or 'è¶…å‚æ•°è°ƒä¼˜' in content
                    elif 'æŸå¤±' in filename or 'loss' in filename.lower():
                        has_specific = 'äº¤å‰ç†µæŸå¤±' in content or 'å¤šä»»åŠ¡æŸå¤±' in content
                    elif 'ä¼˜åŒ–å™¨' in filename or 'optimizer' in filename.lower():
                        has_specific = 'Adamä¼˜åŒ–å™¨' in content or 'SGDä¼˜åŒ–å™¨' in content
                    
                    if is_generic or not has_specific:
                        app_cell_index = i
                        break
        
        if app_cell_index >= 0:
            del notebook['cells'][app_cell_index]
            print(f"    åˆ é™¤æ—§çš„åº”ç”¨éƒ¨åˆ†")
        
        # åœ¨æœ€åæ·»åŠ å®é™…åº”ç”¨ç« èŠ‚(åœ¨æ€»ç»“ä¹‹å‰)
        summary_index = -1
        for i, cell in enumerate(notebook['cells']):
            if cell['cell_type'] == 'markdown':
                content = ''.join(cell['source'])
                if 'æ€»ç»“' in content or 'å°ç»“' in content:
                    summary_index = i
                    break
        
        if summary_index > 0:
            notebook['cells'].insert(summary_index, real_use_cell)
        else:
            notebook['cells'].insert(-1, real_use_cell)
        
        # ä¿å­˜
        with open(notebook_path, 'w', encoding='utf-8') as f:
            json.dump(notebook, f, ensure_ascii=False, indent=1)
        
        print(f"  âœ“ {filename} ä¼˜åŒ–å®Œæˆ(V4ç‰ˆæœ¬)")
        return True
        
    except Exception as e:
        print(f"  âœ— {filename} - ä¼˜åŒ–å¤±è´¥: {e}")
        return False

def extract_title_from_filename(filename):
    """ä»æ–‡ä»¶åæå–æ ‡é¢˜"""
    name = filename.replace('.ipynb', '')
    name = re.sub(r'^\d+_', '', name)
    return name

def main():
    """ä¸»å‡½æ•°"""
    notebooks_dir = Path('/Users/h/practice/CV-main')
    
    print("ğŸš€ å¼€å§‹ä¼˜åŒ–å‡½æ•°/APIä½¿ç”¨è¯´æ˜(V4ç‰ˆæœ¬)...\n")
    print("ğŸ“ æœ¬æ¬¡ä¼˜åŒ–é‡ç‚¹:")
    print("   - ä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¸ªå‡½æ•°")
    print("   - è¿™ä¸ªå‡½æ•°èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜")
    print("   - è¯¦ç»†çš„å®é™…åº”ç”¨åœºæ™¯")
    print("   - å¾ªåºæ¸è¿›çš„å±•å¼€\n")
    
    # éœ€è¦ä¼˜åŒ–çš„å‡½æ•°ç›¸å…³ç¬”è®°æœ¬
    function_notebooks = [
        "108_nn.Moduleæ¨¡å—ä½¿ç”¨.ipynb",
        "114_æ­å»ºå°å®æˆ˜å’ŒSequentialä½¿ç”¨.ipynb",
        "104_Tensorboardä½¿ç”¨.ipynb",
        "115_æŸå¤±å‡½æ•°ä¸åå‘ä¼ æ’­.ipynb",
        "116_ä¼˜åŒ–å™¨.ipynb",
    ]
    
    print(f"æ‰¾åˆ° {len(function_notebooks)} ä¸ªå‡½æ•°ç›¸å…³ç¬”è®°æœ¬\n")
    
    # ä¼˜åŒ–æ¯ä¸ªç¬”è®°æœ¬
    success_count = 0
    for notebook_file in function_notebooks:
        notebook_path = notebooks_dir / notebook_file
        if notebook_path.exists():
            if enhance_function_notebook(notebook_path):
                success_count += 1
        else:
            print(f"  - {notebook_file} ä¸å­˜åœ¨")
    
    print(f"\nâœ… ä¼˜åŒ–å®Œæˆ! æˆåŠŸä¼˜åŒ– {success_count} ä¸ªç¬”è®°æœ¬")
    print("\nğŸ‰ ç°åœ¨æ‰€æœ‰å‡½æ•°éƒ½æœ‰:")
    print("   âœ“ ä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¸ªå‡½æ•°")
    print("   âœ“ è¿™ä¸ªå‡½æ•°èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜")
    print("   âœ“ è¯¦ç»†çš„å®é™…åº”ç”¨åœºæ™¯(5ä¸ª)")
    print("   âœ“ å¾ªåºæ¸è¿›çš„å±•å¼€")

if __name__ == "__main__":
    main()
